<!DOCTYPE HTML><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="keywords" content="Mongodb数据库 , 被动学习"><meta name="baidu-site-verification" content="fmlEuI34ir"><meta name="google-site-verification" content="yCy2azpds5XSuGZvis6OuA-XIGF5GuGpYRAaGfD6o48"><meta name="360-site-verification" content="b7c11a830ef90fd1464ad6206bb7b6e7"><meta name="description" content="一、mongodb1 介绍和安装1.1 nosql的介绍
“NoSQL”⼀词最早于1998年被⽤于⼀个轻量级的关系数据库的名字
随着web2.0的快速发展， NoSQL概念在2009年被提了出来
NoSQL在2010年⻛⽣⽔起， 现在国内外"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Mongodb数据库 | 信息技术交流圈</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><style type="text/css"></style><script src="/libs/jquery/jquery-2.2.0.min.js"></script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?4d1d73af45a62734730491a6b6c41da4",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=+new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"===document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/c221509f.js","daovoice"),daovoice("init",{app_id:"c221509f"}),daovoice("update")</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)}()</script><script>document.write('<script src="https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba" id="sozz"><\/script>')</script><meta name="baidu-site-verification" content><style type="text/css" lang="css">#loading-container{position:fixed;top:0;left:0;min-height:100vh;width:100vw;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#fff;text-align:center;-webkit-transition:opacity 1s ease;-moz-transition:opacity 1s ease;-o-transition:opacity 1s ease;transition:opacity 1s ease}.loading-image{width:120px;height:50px;transform:translate(-50%)}.loading-image div:nth-child(2){-webkit-animation:pacman-balls 1s linear 0s infinite;animation:pacman-balls 1s linear 0s infinite}.loading-image div:nth-child(3){-webkit-animation:pacman-balls 1s linear .33s infinite;animation:pacman-balls 1s linear .33s infinite}.loading-image div:nth-child(4){-webkit-animation:pacman-balls 1s linear .66s infinite;animation:pacman-balls 1s linear .66s infinite}.loading-image div:nth-child(5){-webkit-animation:pacman-balls 1s linear .99s infinite;animation:pacman-balls 1s linear .99s infinite}.loading-image div:first-of-type{width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_up .5s 0s infinite;animation:rotate_pacman_half_up .5s 0s infinite}.loading-image div:nth-child(2){width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_down .5s 0s infinite;animation:rotate_pacman_half_down .5s 0s infinite;margin-top:-50px}@-webkit-keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@-webkit-keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@-webkit-keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}@keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}.loading-image div:nth-child(3),.loading-image div:nth-child(4),.loading-image div:nth-child(5),.loading-image div:nth-child(6){background-color:#49b1f5;width:15px;height:15px;border-radius:100%;margin:2px;width:10px;height:10px;position:absolute;transform:translateY(-6.25px);top:25px;left:100px}.loading-text{margin-bottom:20vh;text-align:center;color:#2c3e50;font-size:2rem;box-sizing:border-box;padding:0 10px;text-shadow:0 2px 10px rgba(0,0,0,.2)}@media only screen and (max-width:500px){.loading-text{font-size:1.5rem}}.fadeout{opacity:0}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}@keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0)}}</style><script>setTimeout(function(){const e=document.getElementById("loading-container");e.className="fadeout",setTimeout(function(){e.style.display="none"},1e3)},1e3)</script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><style type="text/css" lang="css">#loading-container{position:fixed;top:0;left:0;min-height:100vh;width:100vw;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;background:#fff;text-align:center;-webkit-transition:opacity 1s ease;-moz-transition:opacity 1s ease;-o-transition:opacity 1s ease;transition:opacity 1s ease}.loading-image{width:120px;height:50px;transform:translate(-50%)}.loading-image div:nth-child(2){-webkit-animation:pacman-balls 1s linear 0s infinite;animation:pacman-balls 1s linear 0s infinite}.loading-image div:nth-child(3){-webkit-animation:pacman-balls 1s linear .33s infinite;animation:pacman-balls 1s linear .33s infinite}.loading-image div:nth-child(4){-webkit-animation:pacman-balls 1s linear .66s infinite;animation:pacman-balls 1s linear .66s infinite}.loading-image div:nth-child(5){-webkit-animation:pacman-balls 1s linear .99s infinite;animation:pacman-balls 1s linear .99s infinite}.loading-image div:first-of-type{width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_up .5s 0s infinite;animation:rotate_pacman_half_up .5s 0s infinite}.loading-image div:nth-child(2){width:0;height:0;border:25px solid #49b1f5;border-right-color:transparent;border-radius:25px;-webkit-animation:rotate_pacman_half_down .5s 0s infinite;animation:rotate_pacman_half_down .5s 0s infinite;margin-top:-50px}@-webkit-keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@keyframes rotate_pacman_half_up{0%{transform:rotate(270deg)}50%{transform:rotate(1turn)}to{transform:rotate(270deg)}}@-webkit-keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@keyframes rotate_pacman_half_down{0%{transform:rotate(90deg)}50%{transform:rotate(0)}to{transform:rotate(90deg)}}@-webkit-keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}@keyframes pacman-balls{75%{opacity:.7}to{transform:translate(-100px,-6.25px)}}.loading-image div:nth-child(3),.loading-image div:nth-child(4),.loading-image div:nth-child(5),.loading-image div:nth-child(6){background-color:#49b1f5;width:15px;height:15px;border-radius:100%;margin:2px;width:10px;height:10px;position:absolute;transform:translateY(-6.25px);top:25px;left:100px}.loading-text{margin-bottom:20vh;text-align:center;color:#2c3e50;font-size:2rem;box-sizing:border-box;padding:0 10px;text-shadow:0 2px 10px rgba(0,0,0,.2)}@media only screen and (max-width:500px){.loading-text{font-size:1.5rem}}.fadeout{opacity:0}@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}@keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0)}}</style><script>setTimeout(function(){const e=document.getElementById("loading-container");e.className="fadeout",setTimeout(function(){e.style.display="none"},1e3)},1e3)</script><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><div id="loading-container"><p class="loading-text"></p><div class="loading-image"><div></div><div></div><div></div><div></div><div></div></div></div><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/images/loading.gif" data-original="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">信息技术交流圈</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a><ul class="right"><li class="hide-on-med-and-down"><a href="/" class="waves-effect waves-light"><span>首页</span></a></li><li class="hide-on-med-and-down"><a href="/tags" class="waves-effect waves-light"><span>标签</span></a></li><li class="hide-on-med-and-down"><a href="/categories" class="waves-effect waves-light"><span>分类</span></a></li><li class="hide-on-med-and-down"><a href="/archives" class="waves-effect waves-light"><span>归档</span></a></li><li class="hide-on-med-and-down"><a href="/about" class="waves-effect waves-light"><span>关于</span></a></li><li class="hide-on-med-and-down"><a href="/friends" class="waves-effect waves-light"><span>友情链接</span></a></li><li class="hide-on-med-and-down"><a href="/contact" class="waves-effect waves-light"><span>留言板</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fa fa-search" title="搜索"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/images/loading.gif" data-original="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">信息技术交流圈</div><div class="logo-desc">C++ | LeetCode | Algorithm</div></div><ul class="menu-list mobile-menu-list"><li><a href="/" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 首页</a></li><li><a href="/tags" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 标签</a></li><li><a href="/categories" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 分类</a></li><li><a href="/archives" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 归档</a></li><li><a href="/about" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 关于</a></li><li><a href="/friends" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 友情链接</a></li><li><a href="/contact" class="waves-effect waves-light"><i class="fa fa-fw fa-link"></i> 留言板</a></li><li><div class="divider"></div></li><li><a href="https://github.com/muyiio" class="waves-effect waves-light" target="_blank"><i class="fa fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/muyiio" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><script src="/libs/cryptojs/crypto-js.min.js"></script><script></script><div class="bg-cover pd-header post-cover" style="background-image:url(/medias/featureimages/17.jpg)"><div class="container"><div class="row"><div class="col s12 m12 l12"><div class="brand"><div class="description center-align post-title">Mongodb数据库</div></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}#floating-toc-btn{position:fixed;right:20px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Mongodb/" target="_blank"><span class="chip bg-color">Mongodb</span> </a><a href="/tags/数据库/" target="_blank"><span class="chip bg-color">数据库</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/非关系型数据库/" class="post-category" target="_blank">非关系型数据库</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp; 2020-03-09</div><div class="post-author info-break-policy"><i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp; Tyzhao</div><div class="info-break-policy"><i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp; 6.3k</div><div class="info-break-policy"><i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp; 26 分</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp; <span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="一、mongodb"><a href="#一、mongodb" class="headerlink" title="一、mongodb"></a>一、mongodb</h1><h2 id="1-介绍和安装"><a href="#1-介绍和安装" class="headerlink" title="1 介绍和安装"></a>1 介绍和安装</h2><h3 id="1-1-nosql的介绍"><a href="#1-1-nosql的介绍" class="headerlink" title="1.1 nosql的介绍"></a>1.1 nosql的介绍</h3><ul><li>“NoSQL”⼀词最早于1998年被⽤于⼀个轻量级的关系数据库的名字</li><li>随着web2.0的快速发展， NoSQL概念在2009年被提了出来</li><li>NoSQL在2010年⻛⽣⽔起， 现在国内外众多⼤⼩⽹站， 如facebook、 google、 淘宝、 京东、 百度等， 都在使⽤nosql开发⾼性能的产品</li><li>对于⼀名程序员来讲， 使⽤nosql已经成为⼀条必备技能</li><li>NoSQL最常⻅的解释是“non-relational”， “Not Only SQL”也被很多⼈接受， 指的是⾮关系型的数据库</li></ul><h3 id="1-2-关系型和非关系型的介绍"><a href="#1-2-关系型和非关系型的介绍" class="headerlink" title="1.2 关系型和非关系型的介绍"></a>1.2 关系型和非关系型的介绍</h3><p>对于关系型数据库，存储数据的时候需要提前建表建库，随着数据的复杂度越来越高，所建的表的数量也越来越多；但是非关系型却不需要</p><h3 id="1-3-mongodb的势"><a href="#1-3-mongodb的势" class="headerlink" title="1.3 mongodb的势"></a>1.3 mongodb的势</h3><ul><li>易扩展： NoSQL数据库种类繁多， 但是有个共同的特点都是去掉关系数据库的关系型特性。 数据之间⽆关系， 这样就⾮常容易扩展</li><li>⼤数据量， ⾼性能： NoSQL数据库都具有⾮常⾼的读写性能， 尤其在⼤数据量下， 同样表现优秀。 这得益于它的⽆关系性， 数据库的结构简单</li><li>灵活的数据模型： NoSQL⽆需事先为要存储的数据建⽴字段， 随时可以存储⾃定义的数据格式。 ⽽在关系数据库⾥， 增删字段是⼀件⾮常麻烦的事情。 如果是⾮常⼤数据量的表， 增加字段简直就是⼀个噩梦</li></ul><h3 id="1-4-mongodb的安装"><a href="#1-4-mongodb的安装" class="headerlink" title="1.4 mongodb的安装"></a>1.4 mongodb的安装</h3><h4 id="1-命令安装"><a href="#1-命令安装" class="headerlink" title="1 命令安装"></a>1 命令安装</h4><pre><code>sudo apt-get install -y mongodb-org     -y:意思是对安装过程中有yes/no的时候，全部yes

https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/</code></pre><h4 id="1-5-mongodb的启动"><a href="#1-5-mongodb的启动" class="headerlink" title="1.5 mongodb的启动"></a>1.5 mongodb的启动</h4><h4 id="1-服务端mongodb的启动"><a href="#1-服务端mongodb的启动" class="headerlink" title="1 服务端mongodb的启动"></a>1 服务端mongodb的启动</h4><ul><li>查看帮助：mongod –help</li><li>启动：sudo service mongod start</li><li>停止：sudo service mongod stop</li><li>重启：sudo service mongod restart</li><li>查看是否启动成功：ps -ef|grep mongod</li><li>配置文件的位置：/etc/mongod.conf，</li><li>默认端口：<strong>27017</strong></li><li>日志的位置：/var/log/mongodb/mongod.log</li></ul><h4 id="2-客户端mongo"><a href="#2-客户端mongo" class="headerlink" title="2 客户端mongo"></a>2 客户端mongo</h4><ul><li>启动本地客户端:mongo</li><li>查看帮助：mongo –help</li><li>退出：exit或者ctrl+c</li></ul><h4 id="3-服务端mongodb无法启动的解决方法"><a href="#3-服务端mongodb无法启动的解决方法" class="headerlink" title="3 服务端mongodb无法启动的解决方法"></a>3 服务端mongodb无法启动的解决方法</h4><pre><code>sudo mongod --config /etc/mongod.conf &amp;</code></pre><h4 id="4-mongodb的官方文档"><a href="#4-mongodb的官方文档" class="headerlink" title="4 mongodb的官方文档"></a>4 mongodb的官方文档</h4><p>位置：<a href="https://docs.mongodb.com/manual/introduction/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/introduction/</a></p><h2 id="2-入门使用"><a href="#2-入门使用" class="headerlink" title="2 入门使用"></a>2 入门使用</h2><h3 id="2-1-数据库的命令"><a href="#2-1-数据库的命令" class="headerlink" title="2.1 数据库的命令"></a>2.1 数据库的命令</h3><ul><li>查看当前的数据库：db</li><li>查看所有的数据库：show dbs /show databases</li><li>切换数据库：use db_name</li><li>删除当前的数据库：db.dropDatabase()</li></ul><h3 id="2-2-集合的命令"><a href="#2-2-集合的命令" class="headerlink" title="2.2 集合的命令"></a>2.2 集合的命令</h3><ul><li>不手动创建集合： 向不存在的集合中第一次加入数据时， 集合会被创建出来</li><li>手动创建结合：<ul><li>db.createCollection(name,options)</li><li>db.createCollection(“stu”)</li><li>db.createCollection(“sub”, { capped : true, size : 10 } )</li><li>参数capped： 默认值为false表示不设置上限,值为true表示设置上限</li><li>参数size： 当capped值为true时， 需要指定此参数， 表示上限⼤⼩,当⽂档达到上限时， 会将之前的数据覆盖， 单位为字节</li></ul></li><li>查看集合：show collections</li><li>删除集合：db.集合名称.drop()</li></ul><h3 id="2-3-常见的数据类型"><a href="#2-3-常见的数据类型" class="headerlink" title="2.3 常见的数据类型"></a>2.3 常见的数据类型</h3><h4 id="1-常见类型"><a href="#1-常见类型" class="headerlink" title="1 常见类型"></a>1 常见类型</h4><ul><li>Object ID： ⽂档ID</li><li>String： 字符串， 最常见， 必须是有效的UTF-8</li><li>Boolean： 存储⼀个布尔值， true或false</li><li>Integer： 整数可以是32位或64位， 这取决于服务器</li><li>Double： 存储浮点值</li><li>Arrays： 数组或列表， 多个值存储到⼀个键</li><li>Object： ⽤于嵌⼊式的⽂档， 即⼀个值为⼀个⽂档</li><li>Null： 存储Null值</li><li>Timestamp： 时间戳， 表示从1970-1-1到现在的总秒数</li><li>Date： 存储当前⽇期或时间的UNIX时间格式</li></ul><h4 id="2-注意点"><a href="#2-注意点" class="headerlink" title="2 注意点"></a>2 注意点</h4><ul><li><p>创建日期语句如下 ：参数的格式为YYYY-MM-DD new Date(‘2017-12-20’)</p></li><li><p>每个文档都有一个属性， 为_id， 保证每个文档的唯一性</p><p>可以⾃⼰去设置_id插⼊⽂档，如果没有提供， 那么MongoDB为每个文档提供了一个独特的_id， 类型为objectID</p></li><li><p>objectID是一个12字节的十六进制数,每个字节两位，一共是24 位的字符串： 前4个字节为当前时间戳 接下来3个字节的机器ID 接下来的2个字节中MongoDB的服务进程id 最后3个字节是简单的增量值</p></li></ul><h3 id="2-4-mongodb的增删改查"><a href="#2-4-mongodb的增删改查" class="headerlink" title="2.4 mongodb的增删改查"></a>2.4 mongodb的增删改查</h3><p>知识点：</p><ul><li>掌握mongodb的插入和保存</li><li>掌握mongodb的更新操作</li><li>掌握mongodb的查询操作</li><li>掌握mongodb的更新操作</li><li>掌握mongodb的删除操作</li></ul><h4 id="1-插入"><a href="#1-插入" class="headerlink" title="1 插入"></a>1 插入</h4><ul><li><p>db.集合名称.insert(document)</p><p>插入的是字典形式</p><pre><code>  db.stu.insert({name:&#39;gj&#39;,gender:1})
  db.stu.insert({_id:&quot;20170101&quot;,name:&#39;gj&#39;,gender:1})</code></pre><p>插入文档时， 如果不指定_id参数， MongoDB会为文档分配一个唯 一的ObjectId</p></li></ul><h4 id="2-保存"><a href="#2-保存" class="headerlink" title="2 保存"></a>2 保存</h4><p>命令：<code>db.集合名称.save(document)</code> 如果_id已经存在则修改， 如id不存在则添加</p><p>比较实用</p><h4 id="3-简单查询"><a href="#3-简单查询" class="headerlink" title="3 简单查询"></a>3 简单查询</h4><p>命令：<code>db.集合名称.find()</code></p><h4 id="4-mongodb的更新"><a href="#4-mongodb的更新" class="headerlink" title="4 mongodb的更新"></a>4 mongodb的更新</h4><p>命令：<code>db.集合名称.update(&lt;query&gt; ,&lt;update&gt;,{multi: &lt;boolean&gt;})</code></p><ul><li>参数query:查询条件</li><li>参数update:更新操作符</li><li>参数multi:可选， 默认是false，表示只更新找到的第一条记录， 值为true表示把满足条件的全部更新</li></ul><pre class="line-numbers language-python"><code class="language-python">db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'hr'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token string">'11'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>   更新一条，把满足条件的全部替换成<span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token string">'11'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'hr'</span><span class="token punctuation">}</span>没了
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'hr'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>$set<span class="token punctuation">:</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'hys'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    更新一条，只改hys，不改其他内容
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>$set<span class="token punctuation">:</span><span class="token punctuation">{</span>gender<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>multi<span class="token punctuation">:</span>true<span class="token punctuation">}</span><span class="token punctuation">)</span>   更新全部<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>注意：”multi update only works with $ operators”</p><h4 id="5-mongodb的删除"><a href="#5-mongodb的删除" class="headerlink" title="5 mongodb的删除"></a>5 mongodb的删除</h4><p>命令：<code>db.集合名称.remove(&lt;query&gt;,{justOne: &lt;boolean&gt;})</code></p><ul><li>参数query:必选，删除全部</li><li>参数justOne:可选， 如果设为true或1， 则只删除一条， 默认false， 表示删除多条</li></ul><h3 id="2-5-mongodb的高级查询"><a href="#2-5-mongodb的高级查询" class="headerlink" title="2.5 mongodb的高级查询"></a>2.5 mongodb的高级查询</h3><p>知识点：</p><ul><li><p>掌握mongodb的数据查询操作</p></li><li><p>掌握比较运算符的使用</p></li><li><p>掌握逻辑运算符的使用</p></li><li><p>掌握范围运算符的使用</p></li><li><p>了解正则的使用</p></li><li><p>掌握skip和limit的使用</p></li><li><p>掌握投影方法的使用</p></li><li><p>掌握排序方法的使用</p></li><li><p>了解去重方法的使用</p></li></ul><h4 id="1-数据查询"><a href="#1-数据查询" class="headerlink" title="1 数据查询"></a>1 数据查询</h4><ul><li><p>方法find()： 查询</p><p><code>db.集合名称.find({条件文档})</code></p></li><li><p>方法findOne()：查询，只返回第一个</p><p><code>db.集合名称.findOne({条件文档})</code></p></li><li><p>方法pretty()： 将结果格式化</p><p><code>db.集合名称.find({条件文档}).pretty()</code></p></li></ul><h4 id="2-比较运算符"><a href="#2-比较运算符" class="headerlink" title="2 比较运算符"></a>2 比较运算符</h4><p>可以使用以下数据进行练习</p><p>insert可以插入一个列表，把以下的字典都放到列表里即可</p><pre class="line-numbers language-mongodb"><code class="language-mongodb">db.stu.insert([{},{},{}])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"郭靖"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"蒙古"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"⻩蓉"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"桃花岛"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"华筝"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"蒙古"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"⻩药师"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"桃花岛"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"段誉"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"⼤理"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"段王爷"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"⼤理"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"洪七公"</span><span class="token punctuation">,</span> <span class="token property">"hometown"</span> <span class="token operator">:</span> <span class="token string">"华⼭"</span><span class="token punctuation">,</span> <span class="token property">"age"</span> <span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token property">"gender"</span> <span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>等于： 默认是等于判断， 没有运算符</p></li><li><p>小于：<code>$lt （less than）</code></p></li><li><p>小于等于：<code>$lte （less than equal）</code></p><ul><li>db.stu.find({age:{$lte:20},hometown:’蒙古’})</li></ul></li><li><p>大于：<code>$gt （greater than）</code></p></li><li><p>大于等于：<code>$gte</code></p></li><li><p>不等于：<code>$ne</code></p><p>例如：</p><pre class="line-numbers language-python"><code class="language-python">db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"郭靖"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"蒙古"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"黄蓉"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"桃花岛"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> false <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"华筝"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"蒙古"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> false <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"药师"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"桃花岛"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"段誉"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"大理"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"段王爷"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"大理"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"洪七公"</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"华山"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>i不加列表的话，只能插入一条数据</p><pre><code>  查询年龄大于18的所有学生
  db.stu.find({age:{$gte:18}})</code></pre></li></ul><h4 id="3-逻辑运算符"><a href="#3-逻辑运算符" class="headerlink" title="3 逻辑运算符"></a>3 逻辑运算符</h4><p>逻辑运算符主要指与、或逻辑</p><ul><li><p>and：在json中写多个条件即可</p><p>并的关系，同在一个大括号下，不需要每个再加大括号</p><pre><code>  查询年龄大于或等于18， 并且性别为true的学生
  db.stu.find({age:{$gte:18},gender:true})</code></pre></li><li><p>or:使用$or， 值为<strong>数组</strong>， 数组中每个元素为json</p><p>条件放到列表里，列表里的每一个都放到大括号里，与and相反，变复杂了</p><pre class="line-numbers language-python"><code class="language-python">  查询年龄⼤于<span class="token number">18</span>， 或性别为false的学⽣
  db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{</span>$<span class="token operator">or</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token punctuation">{</span>$gt<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>gender<span class="token punctuation">:</span>false<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  查询年龄大于<span class="token number">18</span>或性别为男， 并且姓名是郭靖
  db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{</span>$<span class="token operator">or</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token punctuation">{</span>$gte<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>gender<span class="token punctuation">:</span>true<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>name<span class="token punctuation">:</span><span class="token string">'gj'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="4-范围运算符"><a href="#4-范围运算符" class="headerlink" title="4 范围运算符"></a>4 范围运算符</h4><p>使额头<code>$in 在范围内</code>， <code>$nin 不在范围内</code> 判断数据是否在某个数组内</p><pre><code> 查询年龄为18、 28的学⽣
 db.stu.find({age:{$in:[18,28,38]}})</code></pre><h4 id="5-支持正则表达式（了解）"><a href="#5-支持正则表达式（了解）" class="headerlink" title="5 支持正则表达式（了解）"></a>5 支持正则表达式（了解）</h4><p>使用//或$regex编写正则表达式</p><pre class="line-numbers language-python"><code class="language-python">查询sku以abc开头的数据
db<span class="token punctuation">.</span>products<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{</span>sku<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">^</span>abc<span class="token operator">/</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

查询sku以<span class="token number">789</span>结尾的数据
db<span class="token punctuation">.</span>products<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{</span>sku<span class="token punctuation">:</span><span class="token punctuation">{</span>$regex<span class="token punctuation">:</span><span class="token string">'789$'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"sku"</span> <span class="token punctuation">:</span> <span class="token string">"abc123"</span><span class="token punctuation">,</span> <span class="token string">"description"</span> <span class="token punctuation">:</span> <span class="token string">"Single line description."</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token string">"sku"</span> <span class="token punctuation">:</span> <span class="token string">"abc789"</span><span class="token punctuation">,</span> <span class="token string">"description"</span> <span class="token punctuation">:</span> <span class="token string">"First line\nSecond line"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token string">"sku"</span> <span class="token punctuation">:</span> <span class="token string">"xyz456"</span><span class="token punctuation">,</span> <span class="token string">"description"</span> <span class="token punctuation">:</span> <span class="token string">"Many spaces before     line"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token string">"sku"</span> <span class="token punctuation">:</span> <span class="token string">"xyz789"</span><span class="token punctuation">,</span> <span class="token string">"description"</span> <span class="token punctuation">:</span> <span class="token string">"Multiple\nline description"</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-skip和limit（了解）"><a href="#6-skip和limit（了解）" class="headerlink" title="6 skip和limit（了解）"></a>6 skip和limit（了解）</h4><ul><li><p>法limit()： 读取指定数量的文档</p><pre><code>  db.集合名称.find().limit(NUMBER)

  查询2条学生信息
  db.stu.find().limit(2)</code></pre></li><li><p>法skip()： 跳过指定数量的文档</p><pre><code>  db.集合名称.find().skip(NUMBER)

  db.stu.find().skip(2)</code></pre></li><li><p>同时使用</p><pre><code>  db.stu.find().limit(4).skip(5)
  或 
  db.stu.find().skip(5).limit(4)  效率 比较高，先跳页，再选页</code></pre><p>注意：先使用skip在使用limit的效率要高于前者</p></li></ul><h4 id="7-自定义查询-（了解）"><a href="#7-自定义查询-（了解）" class="headerlink" title="7 自定义查询*（了解）"></a>7 自定义查询*（了解）</h4><p>由于mongo的shell是一个js的执行环境 使⽤$where后⾯写⼀个函数， 返回满⾜条件的数据</p><pre><code> 查询年龄⼤于30的学⽣
 db.stu.find({
     $where:function() {
         return this.age&gt;30;}
 })</code></pre><h4 id="8-投影"><a href="#8-投影" class="headerlink" title="8 投影"></a>8 投影</h4><p>在查询到的返回结果中， 只选择必要的字段</p><p>命令：<code>db.集合名称.find({},{字段名称:1,...})</code></p><blockquote><p>第一个大括号里面放的是条件，比如年龄大于18，后面的大括号，放的是要显示的字段</p></blockquote><p>参数为字段与值， 值为1表示显示， 值为0不显 特别注意： 对于_id列默认是显示的， 如果不显示需要明确设置为0</p><p><code>db.stu.find({},{_id:0,name:1,gender:1})</code></p><h4 id="9-排序"><a href="#9-排序" class="headerlink" title="9 排序"></a>9 排序</h4><p>⽅法sort()， ⽤于对 集进行排序</p><p>命令：<code>db.集合名称.find().sort({字段:1,...})</code></p><p>参数1为升序排列 参数-1为降序排列</p><pre><code> 根据性别降序， 再根据年龄升序
 db.stu.find().sort({gender:-1,age:1})</code></pre><h4 id="10-统计个数"><a href="#10-统计个数" class="headerlink" title="10 统计个数"></a>10 统计个数</h4><p>count()统计结果集中文档条数</p><p>命令：<code>db.集合名称.find({条件}).count()</code> 命令：<code>db.集合名称.count({条件})</code></p><pre><code> db.stu.find({gender:true}).count()
 db.stu.count({age:{$gt:20},gender:true})

 db.stu.find().count({age:{$gte:20}})  这是错误的，这种避免写</code></pre><h4 id="11-消除重复（用的不多）"><a href="#11-消除重复（用的不多）" class="headerlink" title="11 消除重复（用的不多）"></a>11 消除重复（用的不多）</h4><p><code>distinct()</code>对数据进行去重</p><p>命令：<code>db.集合名称.distinct(&#39;去重字段&#39;,{条件})</code></p><pre><code>db.stu.distinct(&#39;hometown&#39;,{age:{$gt:18}}) 
年龄大于18的hometown有哪些，返回一个数组（列表）</code></pre><h2 id="3-聚合操作"><a href="#3-聚合操作" class="headerlink" title="3 聚合操作"></a>3 聚合操作</h2><h3 id="3-1-聚合是什么"><a href="#3-1-聚合是什么" class="headerlink" title="3.1 聚合是什么"></a>3.1 聚合是什么</h3><p>聚合(aggregate)是基于数据处理的聚合管道，每个文档通过一个由多个阶段（stage）组成的管道，可以对每个阶段的管道进行分组、过滤等功能，然后经过一系列的处理，输出相应的结果。</p><p>语法：<code>db.集合名称.aggregate({管道:{表达式}})</code></p><h3 id="3-2-常用管道和表达式"><a href="#3-2-常用管道和表达式" class="headerlink" title="3.2 常用管道和表达式"></a>3.2 常用管道和表达式</h3><h4 id="1-常用管道命令"><a href="#1-常用管道命令" class="headerlink" title="1 常用管道命令"></a>1 常用管道命令</h4><p>在mongodb中，文档处理完毕后， 通过管道进入下一次处理 常用管道命令如下：</p><ul><li><code>$group</code>： 将集合中的文档分组， 可用于统计结果</li><li><code>$match</code>： 过滤数据， 只输出符合条件的文档</li><li><code>$project</code>： 修改输入文档的结构， 如重命名、 增加、 删除字段、 创建计算结果</li><li><code>$sort</code>： 将输入文档排序后输出</li><li><code>$limit</code>： 限制聚合管道返回的文档数</li><li><code>$skip</code>： 跳过指定数量的文档， 并返回余下的文档</li></ul><h4 id="2-常用表达式"><a href="#2-常用表达式" class="headerlink" title="2 常用表达式"></a>2 常用表达式</h4><p>表达式：输出 语法：<code>表达式:&#39;$列名&#39;</code> 常用表达式:</p><ul><li><code>$sum</code>： 计算总和， $sum:1 表示以⼀倍计数</li><li><code>$avg</code>： 计算平均值</li><li><code>$min</code>： 获取最小值</li><li><code>$max</code>： 获取最大值</li><li><code>$push</code>： 在结果文档中插入值到⼀个数组中</li></ul><h3 id="3-3-管道命令之-group"><a href="#3-3-管道命令之-group" class="headerlink" title="3.3 管道命令之$group"></a>3.3 管道命令之<code>$group</code></h3><p><strong>字段名前加要$， 语法前也加</strong></p><h4 id="3-1-按照某个字段进行分组"><a href="#3-1-按照某个字段进行分组" class="headerlink" title="3.1 按照某个字段进行分组"></a>3.1 按照某个字段进行分组</h4><p><code>$group</code>是所有聚合命令中用的最多的一个命令，用来将集合中的文档分组，可用于统计结果</p><p>使用示例如下</p><pre class="line-numbers language-python"><code class="language-python">db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
    <span class="token punctuation">{</span>$group<span class="token punctuation">:</span>
        <span class="token punctuation">{</span>
            _id<span class="token punctuation">:</span><span class="token string">"$gender"</span><span class="token punctuation">,</span>
            counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token string">"$gender"</span><span class="token punctuation">,</span>counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># _id 格式必须这样写，表示按什么字段分组，counter是自定义的</span>
<span class="token comment" spellcheck="true"># gender前必须加$,如果不加，相当于没有按这个字段分组，而是全部</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其中注意点：</p><ul><li><code>db.db_name.aggregate</code>是语法，所有的管道命令都需要写在其中</li><li><code>_id</code> 表示分组的依据，按照哪个字段进行分组，需要使用<code>$gender</code>表示选择这个字段进行分组</li><li><code>$sum:1</code> 表示把每条数据作为1进行统计，统计的是该分组下面数据的条数</li></ul><h4 id="3-2-group-by-null"><a href="#3-2-group-by-null" class="headerlink" title="3.2 group by null"></a>3.2 group by null</h4><p>当我们需要统计整个文档的时候，<code>$group</code> 的另一种用途就是把整个文档分为一组进行统计</p><p>使用实例如下：</p><pre class="line-numbers language-python"><code class="language-python">db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
    <span class="token punctuation">{</span>$group<span class="token punctuation">:</span>
        <span class="token punctuation">{</span>
            _id<span class="token punctuation">:</span>null<span class="token punctuation">,</span>
            counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span>null<span class="token punctuation">,</span>counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># 将上面的写成了一行</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其中注意点：</p><ul><li><code>_id:null</code> 表示不指定分组的字段，即统计<strong>整个文档</strong>，此时获取的<code>counter</code>表示整个文档的个数</li></ul><h4 id="3-3-数据透视"><a href="#3-3-数据透视" class="headerlink" title="3.3 数据透视"></a>3.3 数据透视</h4><blockquote><p>前面用的group都是对有数值的处理，比如求和，最大，最小，这里的数据透视是对分组后，包含的其他字段的文字</p></blockquote><p>正常情况在统计的不同性别的数据的时候，需要知道所有的name，需要逐条观察，如果通过某种方式把所有的name放到一起，那么此时就可以理解为数据透视</p><p>使用示例如下：</p><ol><li><p>统计不同性别的学生</p><pre class="line-numbers language-python"><code class="language-python"> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
     <span class="token punctuation">{</span>$group<span class="token punctuation">:</span>
         <span class="token punctuation">{</span>
             _id<span class="token punctuation">:</span>null<span class="token punctuation">,</span>
             name<span class="token punctuation">:</span><span class="token punctuation">{</span>$push<span class="token punctuation">:</span><span class="token string">"$name"</span><span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">)</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><pre><code>
   ```python
   db.stu.aggregate({$group:{_id:&quot;$gender&quot;,name:{$push:&quot;$name&quot;},hometown:{$push:&quot;$hometown&quot;}}})
   # 按性别进行分组，被分成两组，一组为男，一组为女，name为符合条件的姓名字段和home段</code></pre><ol start="2"><li><p>使用<code>$$ROOT</code>可以将整个文档放入数组中</p><pre><code> db.stu.aggregate(
     {$group:
         {
             _id:null,
             name:{$push:&quot;$$ROOT&quot;}
         }
     }
 )</code></pre></li></ol><h4 id="3-4-多字段统计"><a href="#3-4-多字段统计" class="headerlink" title="3.4 多字段统计"></a>3.4 多字段统计</h4><blockquote><p>前面是一个字段的统计，多个字段怎么统计呢？</p><p>多字段分组，可以达到去重的效果</p></blockquote><p>对于如下数据，需要统计出每个country/province下的userid的数量（同一个userid只统计一次）</p><pre><code>{ &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;a&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;b&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;a&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;c&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;bj&quot;, &quot;userid&quot; : &quot;da&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;bj&quot;, &quot;userid&quot; : &quot;fa&quot; }
</code></pre><p>参考答案</p><pre class="line-numbers language-python"><code class="language-python">db<span class="token punctuation">.</span>tv3<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
  <span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>country<span class="token punctuation">:</span><span class="token string">'$country'</span><span class="token punctuation">,</span>province<span class="token punctuation">:</span><span class="token string">'$province'</span><span class="token punctuation">,</span>userid<span class="token punctuation">:</span><span class="token string">'$userid'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>country<span class="token punctuation">:</span><span class="token string">'$_id.country'</span><span class="token punctuation">,</span>province<span class="token punctuation">:</span><span class="token string">'$_id.province'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 1、_id:对应一个字典,共有五个字典，以下是第一个管道的结果</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>country<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>country<span class="token punctuation">:</span><span class="token string">"$country"</span><span class="token punctuation">,</span>china<span class="token punctuation">:</span><span class="token string">"$china"</span><span class="token punctuation">,</span>province<span class="token punctuation">:</span><span class="token string">"$province"</span><span class="token punctuation">,</span>userid<span class="token punctuation">:</span><span class="token string">"$userid"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"country"</span> <span class="token punctuation">:</span> <span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token string">"province"</span> <span class="token punctuation">:</span> <span class="token string">"sh"</span><span class="token punctuation">,</span> <span class="token string">"userid"</span> <span class="token punctuation">:</span> <span class="token string">"a"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"country"</span> <span class="token punctuation">:</span> <span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token string">"province"</span> <span class="token punctuation">:</span> <span class="token string">"bj"</span><span class="token punctuation">,</span> <span class="token string">"userid"</span> <span class="token punctuation">:</span> <span class="token string">"fa"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"country"</span> <span class="token punctuation">:</span> <span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token string">"province"</span> <span class="token punctuation">:</span> <span class="token string">"sh"</span><span class="token punctuation">,</span> <span class="token string">"userid"</span> <span class="token punctuation">:</span> <span class="token string">"b"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"country"</span> <span class="token punctuation">:</span> <span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token string">"province"</span> <span class="token punctuation">:</span> <span class="token string">"sh"</span><span class="token punctuation">,</span> <span class="token string">"userid"</span> <span class="token punctuation">:</span> <span class="token string">"c"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"country"</span> <span class="token punctuation">:</span> <span class="token string">"china"</span><span class="token punctuation">,</span> <span class="token string">"province"</span> <span class="token punctuation">:</span> <span class="token string">"bj"</span><span class="token punctuation">,</span> <span class="token string">"userid"</span> <span class="token punctuation">:</span> <span class="token string">"da"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token operator">></span> 

<span class="token comment" spellcheck="true"># 2、第二个管道，是以第一个管道的结果做为输入，所以，country这个字段，用的是第一个管道的_id，对第二个管道的结果数量求和</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-4-管道命令之-match"><a href="#3-4-管道命令之-match" class="headerlink" title="3.4 管道命令之$match"></a>3.4 管道命令之<code>$match</code></h3><p><code>$match</code>用于进行数据的过滤，是在能够在聚合操作中使用的命令，和<code>find</code>区别在于<code>$match</code> 操作可以把结果交给下一个管道处理，而<code>find</code>不行</p><p>使用示例如下：</p><ol><li><p>查询年龄大于20的学生</p><pre><code> db.stu.aggregate(
     {$match:{age:{$gt:20}}
     )</code></pre></li><li><p>查询年龄大于20的男女学生的人数</p><pre class="line-numbers language-python"><code class="language-python"> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
     <span class="token punctuation">{</span>$match<span class="token punctuation">:</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token punctuation">{</span>$gt<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span>，
     <span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token string">"$gender"</span><span class="token punctuation">,</span>counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
     <span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 年龄大于40岁的，按性别分组后的人数</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
    <span class="token punctuation">{</span>$match<span class="token punctuation">:</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token punctuation">{</span>$gte<span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>gender<span class="token punctuation">:</span><span class="token string">"$gender"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

结果
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">"gender"</span> <span class="token punctuation">:</span> true <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token operator">></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="3-5-管道命令之-project"><a href="#3-5-管道命令之-project" class="headerlink" title="3.5 管道命令之$project"></a>3.5 管道命令之<code>$project</code></h3><p><code>$project</code>用于修改文档的输入输出结构，例如重命名，增加，删除字段</p><p>使用示例如下：</p><ol><li><p>查询学生的年龄、姓名，仅输出年龄姓名</p><pre><code> db.stu.aggregate(
     {$project:{_id:0,name:1,age:1}}
     )</code></pre></li><li><p>查询男女生人生，输出人数</p><pre><code> db.stu.aggregate(
     {$group:{_id:&quot;$gender&quot;,counter:{$sum:1}}}，
     {$project:{_id:0,counter:1}}
     )</code></pre></li></ol><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>hometown<span class="token punctuation">:</span><span class="token string">"$hometown"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>$project<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>hometown<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 如果想让hometown显示出来，就用第一个管道的—id里的hometown</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span><span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token punctuation">{</span>hometown<span class="token punctuation">:</span><span class="token string">"$hometown"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>$project<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>hometown<span class="token punctuation">:</span><span class="token string">"$_id.hometown"</span><span class="token punctuation">,</span>count<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"华⼭"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"⼤理"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"桃花岛"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"count"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"hometown"</span> <span class="token punctuation">:</span> <span class="token string">"蒙古"</span> <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1 动手练习</p><p>对于如下数据：统计出每个country/province下的userid的数量（同一个userid只统计一次），结果中的字段为{country:”<strong>“，province:”</strong>“，counter:”*”}</p><pre><code>{ &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;a&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;b&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;a&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;sh&quot;, &quot;userid&quot; : &quot;c&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;bj&quot;, &quot;userid&quot; : &quot;da&quot; }  
{  &quot;country&quot; : &quot;china&quot;, &quot;province&quot; : &quot;bj&quot;, &quot;userid&quot; : &quot;fa&quot; }</code></pre><p>参考答案</p><pre><code>db.tv3.aggregate(
  {$group:{_id:{country:&#39;$country&#39;,province:&#39;$province&#39;,userid:&#39;$userid&#39;}}},
  {$group:{_id:{country:&#39;$_id.country&#39;,province:&#39;$_id.province&#39;},count:{$sum:1}}},
  {$project:{_id:0,country:&#39;$_id.country&#39;,province:&#39;$_id.province&#39;,counter:&#39;$count&#39;}}
  )</code></pre><h3 id="3-6-管道命令之-sort"><a href="#3-6-管道命令之-sort" class="headerlink" title="3.6 管道命令之$sort"></a>3.6 管道命令之<code>$sort</code></h3><p><code>$sort</code>用于将输入的文档排序后输出</p><p>使用示例如下：</p><ol><li><p>查询学生信息，按照年龄升序</p><pre><code> db.stu.aggregate({$sort:{age:1}})
</code></pre></li><li><p>查询男女人数，按照人数降序</p><pre><code> db.stu.aggregate(
     {$group:{_id:&quot;$gender&quot;,counter:{$sum:1}}},
     {$sort:{counter:-1}}
 )</code></pre></li></ol><h3 id="3-7-管道命令之-skip-和-limit"><a href="#3-7-管道命令之-skip-和-limit" class="headerlink" title="3.7 管道命令之$skip 和 $limit"></a>3.7 管道命令之<code>$skip</code> 和 <code>$limit</code></h3><ul><li><code>$limit</code>限制返回数据的条数</li><li><code>$skip</code> 跳过指定的文档数，并返回剩下的文档数</li><li>同时使用时先使用skip在使用limit</li></ul><p>使用示例如下：</p><ol><li><p>查询2条学生信息</p><pre class="line-numbers language-python"><code class="language-python"> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
     <span class="token punctuation">{</span>$limit<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">}</span>
 <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>查询从第三条开始的学生信息</p><pre class="line-numbers language-python"><code class="language-python"> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
     <span class="token punctuation">{</span>$skip<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span>
 <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>统计男女生人数，按照人数升序，返回第二条数据</p><pre class="line-numbers language-python"><code class="language-python"> db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>
     <span class="token punctuation">{</span>$group<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span><span class="token string">"$gender"</span><span class="token punctuation">,</span>counter<span class="token punctuation">:</span><span class="token punctuation">{</span>$sum<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token comment" spellcheck="true"># 按时性别计数</span>
     <span class="token punctuation">{</span>$sort<span class="token punctuation">:</span><span class="token punctuation">{</span>counter<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token comment" spellcheck="true"># 对数量排序</span>
     <span class="token punctuation">{</span>$skip<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token comment" spellcheck="true"># 跳一行    </span>
     <span class="token punctuation">{</span>$limit<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span>                    <span class="token comment" spellcheck="true"># 显示一行</span>
 <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h2 id="4-索引备份"><a href="#4-索引备份" class="headerlink" title="4 索引备份"></a>4 索引备份</h2><h3 id="1-mongodb的索引"><a href="#1-mongodb的索引" class="headerlink" title="1. mongodb的索引"></a>1. mongodb的索引</h3><p>知识点</p><ul><li>掌握mongodb索引的创建，删除操作</li><li>掌握mongodb查看索引的方法</li><li>掌握mongodb创建联合索引的方法</li><li>掌握mongodb创建唯一索引的方法</li></ul><h4 id="1-1-为什么mongdb需要创建索引"><a href="#1-1-为什么mongdb需要创建索引" class="headerlink" title="1.1 为什么mongdb需要创建索引"></a>1.1 为什么mongdb需要创建索引</h4><ul><li>加快查询速度</li><li>进行数据的去重</li></ul><h4 id="1-2-创建简单的索引方法"><a href="#1-2-创建简单的索引方法" class="headerlink" title="1.2 创建简单的索引方法"></a>1.2 创建简单的索引方法</h4><ul><li>语法：<ul><li><code>db.集合.ensureIndex({属性:1})</code>，1表示升序， -1表示降序</li><li><code>db.集合.createIndex({属性:1})</code></li><li>上面两个命令效果等价</li></ul></li><li>具体操作：db.db_name.ensureIndex({name:1})</li></ul><h4 id="1-3-创建索引前后查询速度对比"><a href="#1-3-创建索引前后查询速度对比" class="headerlink" title="1.3 创建索引前后查询速度对比"></a>1.3 创建索引前后查询速度对比</h4><p>测试：插入10万条数据到数据库中 插入数据：</p><pre><code>for(i=0;i&lt;100000;i++){db.t255.insert({name:&#39;test&#39;+i,age:i})}</code></pre><p>创建索引前：</p><pre><code>db.t1.find({name:&#39;test10000&#39;})
db.t1.find({name:&#39;test10000&#39;}).explain(&#39;executionStats&#39;)</code></pre><p>创建索引后：</p><pre><code>db.t255.ensureIndex({name:1})
db.t1.find({name:&#39;test10000&#39;}).explain(&#39;executionStats&#39;)</code></pre><p>前后速度对比</p><p>默认情况下_id是集合的索引</p><p>查看方式：<code>db.collection_name.getIndexes()</code></p><p>添加索引前：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>age<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 1、插入内容</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">"nInserted"</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>                              <span class="token comment" spellcheck="true"># 2、显示内容</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">"5ae0232f625b9ddd91a0e7ae"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true">#3、查看索引</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>                                <span class="token comment" spellcheck="true"># 4/默认关键字的索引是_id</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>添加name为索引后:</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token string">"createdCollectionAutomatically"</span> <span class="token punctuation">:</span> false<span class="token punctuation">,</span>
    <span class="token string">"numIndexesBefore"</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">"numIndexesAfter"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"ok"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>                     <span class="token comment" spellcheck="true"># 又多了一个索引值，name</span>
            <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"name_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-5-创建唯一索引"><a href="#1-5-创建唯一索引" class="headerlink" title="1.5 创建唯一索引"></a>1.5 创建唯一索引</h4><p>在默认情况下mongdb的索引字段的值是可以相同的,仅仅能够提高查询速度</p><p>添加唯一索引的语法：</p><pre class="line-numbers language-json"><code class="language-json">db.collection_name.ensureIndex(<span class="token punctuation">{</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">"unique"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使用普通索引的效果如下：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>蒙
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"name_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>age<span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    ??? <span class="token comment" spellcheck="true">#对name使用普通索引后，再插入索引值相同的hello，                                            是可以成功的</span>
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">"nInserted"</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">"5ae0232f625b9ddd91a0e7ae"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">"5ae02421625b9ddd91a0e7af"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">30</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">"_id"</span> <span class="token punctuation">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">"5ae02432625b9ddd91a0e7b0"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>添加age为唯一索引之后：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>createIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>unique<span class="token punctuation">:</span>true<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token string">"createdCollectionAutomatically"</span> <span class="token punctuation">:</span> false<span class="token punctuation">,</span>
    <span class="token string">"numIndexesBefore"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"numIndexesAfter"</span> <span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"ok"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"name_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"unique"</span> <span class="token punctuation">:</span> true<span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"age_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"world"</span><span class="token punctuation">,</span>age<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>      ????设置成唯一后，再插入相同的数值就报错
WriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">"nInserted"</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"writeError"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"code"</span> <span class="token punctuation">:</span> <span class="token number">11000</span><span class="token punctuation">,</span>
        <span class="token string">"errmsg"</span> <span class="token punctuation">:</span> <span class="token string">"E11000 duplicate key error collection: test2000.test2000 index: age_1 dup key: { : 20.0 }"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-6-删除索引"><a href="#1-6-删除索引" class="headerlink" title="1.6 删除索引"></a>1.6 删除索引</h4><p>语法：<code>db.t1.dropIndex({&#39;索引名称&#39;:1})</code></p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"name_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"unique"</span> <span class="token punctuation">:</span> true<span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"age_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"nIndexesWas"</span> <span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"ok"</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>dropIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string">"nIndexesWas"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"ok"</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-6-建立复合索引"><a href="#1-6-建立复合索引" class="headerlink" title="1.6 建立复合索引"></a>1.6 建立复合索引</h4><p>在进行数据去重的时候，可能用一个字段来保证数据的唯一性，这个时候可以考虑建立复合索引来实现。</p><p>例如：抓全贴吧信息，如果把帖子的名字作为唯一索引对数据进行去重是不可取的，因为可能有很多帖子名字相同</p><p>建立复合索引的语法：<code>db.collection_name.ensureIndex({字段1:1,字段2:1})</code></p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>createIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>age<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token string">"createdCollectionAutomatically"</span> <span class="token punctuation">:</span> false<span class="token punctuation">,</span>
    <span class="token string">"numIndexesBefore"</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">"numIndexesAfter"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"ok"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token operator">></span> db<span class="token punctuation">.</span>test2000<span class="token punctuation">.</span>getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"_id"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"_id_"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">"v"</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"key"</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">"age"</span> <span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span> <span class="token punctuation">:</span> <span class="token string">"name_1_age_1"</span><span class="token punctuation">,</span>
        <span class="token string">"ns"</span> <span class="token punctuation">:</span> <span class="token string">"test2000.test2000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-7-建立索引注意点"><a href="#1-7-建立索引注意点" class="headerlink" title="1.7 建立索引注意点"></a>1.7 建立索引注意点</h4><ul><li><p>根据需要选择是否需要建立唯一索引</p></li><li><p>索引字段是升序还是降序在单个索引的情况下不影响查询效率，但是带复合索引的条件下会有影响</p><blockquote><p>例如：在进行查询的时候如果字段1需要升序的方式排序输出，字段2需要降序的方式排序输出，那么此时复合索引的建立需要把字段1设置为1，字段2设置为-1</p></blockquote></li></ul><h3 id="2-mongodb的备份和恢复"><a href="#2-mongodb的备份和恢复" class="headerlink" title="2. mongodb的备份和恢复"></a>2. mongodb的备份和恢复</h3><p>知识点</p><ul><li>掌握mongdb的备份和恢复命令</li></ul><h4 id="2-1-备份"><a href="#2-1-备份" class="headerlink" title="2.1 备份"></a>2.1 备份</h4><p>备份的语法：</p><pre><code>mongodump -h dbhost -d dbname -o dbdirectory</code></pre><ul><li><code>-h</code>： 服务器地址， 也可以指定端⼝号</li><li><code>-d</code>： 需要备份的数据库名称</li><li><code>-o</code>： 备份的数据存放位置， 此⽬录中存放着备份出来的数据</li></ul><p>示例：<code>mongodump -h 192.168.196.128:27017 -d test1 -o ~/Desktop/test1bak</code></p><h4 id="2-2-恢复"><a href="#2-2-恢复" class="headerlink" title="2.2 恢复"></a>2.2 恢复</h4><p>恢复语法：<code>mongorestore -h dbhost -d dbname --dir dbdirectory</code></p><ul><li><code>-h</code>： 服务器地址</li><li><code>-d</code>： 需要恢复的数据库实例</li><li><code>--dir</code>： 备份数据所在位置</li></ul><p>示例：<code>mongorestore -h 192.168.196.128:27017 -d test2 --dir ~/Desktop/test1bak/test1</code></p><h2 id="5-python交互"><a href="#5-python交互" class="headerlink" title="5 python交互"></a>5 python交互</h2><h3 id="1-mongdb和python交互的模块"><a href="#1-mongdb和python交互的模块" class="headerlink" title="1. mongdb和python交互的模块"></a>1. mongdb和python交互的模块</h3><p><code>pymongo</code> 提供了mongdb和python交互的所有方法 安装方式: <code>pip install pymongo</code></p><h3 id="2-使用pymongo"><a href="#2-使用pymongo" class="headerlink" title="2. 使用pymongo"></a>2. 使用pymongo</h3><ol><li><p>导入pymongo并选择要操作的集合 数据库和集合乜有会自动创建</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient
 client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span>host<span class="token punctuation">,</span>port<span class="token punctuation">)</span>
 collection <span class="token operator">=</span> client<span class="token punctuation">[</span>db名<span class="token punctuation">]</span><span class="token punctuation">[</span>集合名<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>添加一条数据</p><pre class="line-numbers language-python"><code class="language-python">ret <span class="token operator">=</span> collection<span class="token punctuation">.</span>insert_one<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10010"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>添加多条数据</p><pre class="line-numbers language-python"><code class="language-python"> item_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test1000{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
     <span class="token comment" spellcheck="true">#insert_many接收一个列表，列表中为所有需要插入的字典</span>
 t <span class="token operator">=</span> collection<span class="token punctuation">.</span>insert_many<span class="token punctuation">(</span>item_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>查找一条数据</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true">#find_one查找并且返回一个结果,接收一个字典形式的条件</span>
 t <span class="token operator">=</span> collection<span class="token punctuation">.</span>find_one<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10005"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>查找全部数据</p><p>结果是一个Cursor游标对象，是一个可迭代对象，可以类似读文件的指针，但是只能够进行一次读取</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true">#find返回所有满足条件的结果，如果条件为空，则返回数据库的所有</span>
 t <span class="token operator">=</span> collection<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10005"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token comment" spellcheck="true">#结果是一个Cursor游标对象，是一个可迭代对象，可以类似读文件的指针，</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">:</span> <span class="token comment" spellcheck="true">#此时t中没有内容</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>更新一条数据 注意使用<code>$set</code>命令</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true">#update_one更新一条数据</span>
 collection<span class="token punctuation">.</span>update_one<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10005"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"$set"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"new_test10005"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token comment" spellcheck="true">#与update的方法一样 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>更新全部数据</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true"># update_one更新全部数据</span>
 collection<span class="token punctuation">.</span>update_many<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10005"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">"$set"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"new_test10005"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>删除一条数据</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true">#delete_one删除一条数据</span>
 collection<span class="token punctuation">.</span>delete_one<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10010"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>删除全部数据</p><pre class="line-numbers language-python"><code class="language-python"> <span class="token comment" spellcheck="true">#delete_may删除所有满足条件的数据</span>
 collection<span class="token punctuation">.</span>delete_many<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"test10010"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><h2 id="6-mongodb与redis的区别"><a href="#6-mongodb与redis的区别" class="headerlink" title="6 mongodb与redis的区别"></a>6 mongodb与redis的区别</h2><table><thead><tr><th></th><th>mongodb</th><th>redis</th></tr></thead><tbody><tr><td></td><td>MongoDB却是一个“存储数据”的系统，增删改查可以添加很多条件，就像SQL数据库一样灵活</td><td>Redis主要把数据存储在内存中，其“缓存”的性质远大于其“数据存储“的性质，其中数据的增删改查也只是像变量操作一样简单</td></tr><tr><td>性能</td><td>依赖内存，TPS较高</td><td>依赖内存，TPS非常高</td></tr><tr><td>可操作性</td><td>丰富的数据表达、索引；最类似于关系数据库，支持丰富的查询语言</td><td>数据丰富，较少的IO</td></tr><tr><td>应用场景</td><td>海量数据的访问效率提升</td><td>较小数据量的性能及运算</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table></div><hr><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.88rem}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fa fa-close"></i></a><h4 class="reward-title">写作不易，客官能否打赏一杯奶茶？</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="/images/loading.gif" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="/images/loading.gif" data-original="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div></div><script src="/libs/share/js/social-share.min.js"></script><div class="reprint" id="reprint-statement"><p class="reprint-tip"><i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp; <span>转载规则</span></p><div class="center-align"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><img alt="" style="border-width:0" src="/images/loading.gif" data-original="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></div><br><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">《Mongodb数据库 》 </span>由 <a xmlns:cc="http://creativecommons.org/ns#" href="/mongodb.html" property="cc:attributionName" rel="cc:attributionURL">Tyzhao </a>采用 <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">知识共享署名 4.0 国际许可协议 </a>进行许可。</div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments input[type=email],#vcomments input[type=text],#vcomments input[type=url],#vcomments textarea{box-sizing:border-box}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#42b983;font-weight:500;text-decoration:underline}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div id="vcomments" class="card-content"></div></div><script src="//code.bdstatic.com/npm/leancloud-storage@4.12.2/dist/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"",appKey:"",notify:!0,verify:!1,visitor:!1,avatar:"wavatar",pageSize:"10",lang:"zh-cn",placeholder:"如果你没有GitHub账号，还可以在这里评论啦！"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fa fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/linux.html"><div class="card-image"><img src="/images/loading.gif" data-original="/medias/featureimages/16.jpg" class="responsive-img" alt="Linux "> <span class="card-title">Linux</span></div></a><div class="card-content article-content"><div class="summary block-with-text">这篇文章详细的记录我学习Linux的过程</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i>2022-02-07 </span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/操作系统/" class="post-category" target="_blank">操作系统</a></span></div></div><div class="card-action article-tags"><a href="/tags/操作系统/" target="_blank"><span class="chip bg-color">操作系统</span> </a><a href="/tags/Linux/" target="_blank"><span class="chip bg-color">Linux</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fa fa-chevron-right"></i></div><div class="card"><a href="/shu-ju-fen-xi-san-jian-ke.html"><div class="card-image"><img src="/images/loading.gif" data-original="/medias/featureimages/20.jpg" class="responsive-img" alt="数据分析 "> <span class="card-title">数据分析</span></div></a><div class="card-content article-content"><div class="summary block-with-text">这篇文章详细的记录我学习数据分析的过程</div><div class="publish-info"><span class="publish-date"><i class="fa fa-clock-o fa-fw icon-date"></i>2020-03-07 </span><span class="publish-author"><i class="fa fa-bookmark fa-fw icon-category"></i> <a href="/categories/数据分析/" class="post-category" target="_blank">数据分析</a></span></div></div><div class="card-action article-tags"><a href="/tags/Python/" target="_blank"><span class="chip bg-color">Python</span> </a><a href="/tags/数据分析/" target="_blank"><span class="chip bg-color">数据分析</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){var n,t,o,i;void 0===window.getSelection||(""+(n=window.getSelection())).length<Number.parseInt("120")||(t=document.getElementsByTagName("body")[0],(o=document.createElement("div")).style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName&&(o.innerHTML="<pre>"+o.innerHTML+"</pre>"),i=document.location.href,o.innerHTML+='<br />来源: 信息技术交流圈<br />作者: Tyzhao<br />链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200))})</script></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fa fa-list"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),headingSelector:"h1, h2, h3, h4"});let t=0,e="toc-heading-",n=($("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h1, h2, h3, h4").each(function(){$(this).attr("id",e+ ++t)}),parseInt(.4*$(window).height()-64)),o=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>n?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});const i="expanded";let a=$("#toc-aside"),c=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){a.hasClass(i)?(a.removeClass(i).slideUp(500),c.removeClass("l9")):(a.addClass(i).slideDown(500),c.addClass("l9"));var e="artDetail";if(0!==(e=$("#artDetail")).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#prenext-posts").width(t)}})})</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="Copy-right">&copy; 2020 Yshawlon. All Rights Reserved. &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp; <span class="white-color">64.2k 丨 <span id="sitetime"></span> <span id="busuanzi_container_site_pv" style="display:none"><i class="fa fa-users"></i> 本站总访问量 <span id="busuanzi_value_site_pv" class="red-color"></span> </span><span id="busuanzi_container_site_uv" style="display:none">人次,&nbsp;<i class="fa fa-user"></i>访客数 <span id="busuanzi_value_site_uv" class="blue-color"></span> 人.</span></span></div><div class="social-link social-statis"><a href="https://github.com/Xiangmou" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fa fa-github"></i> </a><a href="https://www.csdn.net/yu3151883057" class="tooltipped" target="_blank" data-tooltip="访问我的CSDN主页" data-position="top" data-delay="50"><i class="fa fa-codiepie"></i> </a><a href="https://www.zhihu.com/zhihu.com/people/muyiio" class="tooltipped" target="_blank" data-tooltip="访问我的知乎" data-position="top" data-delay="50"><i class="fa fa-inverse">知</i> </a><a href="https://user.qzone.qq.com/3152344537" class="tooltipped" target="_blank" data-tooltip="访问我的QQ空间" data-position="top" data-delay="50"><i class="fa fa-qq"></i> </a><a href="mailto:3152344537@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fa fa-envelope-open"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i></a></div></div><div class="container row center-align"><div class="github-badge"><a style="color:#fff" rel="license" href="https://hexo.io/" target="_blank" title="由 Hexo 强力驱动"><span class="badge-subject">Powered</span><span class="badge-value bg-blue">Hexo</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://github.com/" target="_blank" title="静态网页托管于 GitHub Pages 和 Coding Pages"><span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen">GitHub & Coding</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://www.cloud.tencent.com/" target="_blank" title="腾讯云提供域名相关服务"><span class="badge-subject">DNS</span><span class="badge-value bg-blueviolet">Tencent cloud</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://www.jsdelivr.com/" target="_blank" title="jsDelivr 提供 CDN 加速服务"><span class="badge-subject">CDN</span><span class="badge-value bg-orange">jsDelivr</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://github.com/blinkfox/hexo-theme-matery/" target="_blank" title="站点使用 Matery 主题"><span class="badge-subject">Theme</span><span class="badge-value bg-blue">Matery</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="本站点采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可"><span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-lightgrey">BY-NC-SA 4.0</span></a></div><div class="github-badge"><a style="color:#fff" rel="license" href="https://996.icu/" target="_blank" title="支持 996.ICU"><span class="badge-subject">Link</span><span class="badge-value bg-red">996.ICU</span></a></div><div class="github-badge"><span class="badge-subject">UV</span><span class="badge-value bg-orange" id="busuanzi_value_site_uv"></span></div><div class="github-badge"><span class="badge-subject">PV</span><span class="badge-value bg-brightgreen" id="busuanzi_value_site_pv"></span></div><div class="github-badge"><span class="badge-subject">WordCount</span><span class="badge-value bg-blueviolet">64.2k</span></div></div></footer><div class="progress-bar"></div><script>$(document).ready(function(){var e=setInterval(function(){"none"!=document.getElementById("busuanzi_container_site_pv").style.display&&($("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html())+n),clearInterval(e)),"none"!=$("#busuanzi_container_site_pv").css("display")&&($("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html())+t),clearInterval(e))},50),n=8e4,t=2e4})</script><script language="javascript">function siteTime(){window.setTimeout("siteTime()",1e3);var e=36e5,t=24*e,o=(l=new Date).getFullYear(),i=l.getMonth()+1,a=l.getDate(),n=l.getHours(),r=l.getMinutes(),l=l.getSeconds(),s=Date.UTC(2020,1,1,0,0,0),o=Date.UTC(o,i,a,n,r,l)-s,i=Math.floor(o/31536e6),a=Math.floor(o/t-365*i),n=Math.floor((o-(365*i+a)*t)/e),r=Math.floor((o-(365*i+a)*t-n*e)/6e4),l=Math.floor((o-(365*i+a)*t-n*e-6e4*r)/1e3);document.getElementById("sitetime").innerHTML="本站已运行 "+i+" 年 "+a+" 天 "+n+" 小时 "+r+" 分钟 "+l+" 秒"}siteTime()</script><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fa fa-angle-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script type="text/javascript">var st,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="Σ(っ °Д °;)っ喔哟，崩溃啦！",clearTimeout(st)):(document.title="φ(゜▽゜*)♪咦，又好了！",st=setTimeout(function(){document.title=OriginTitile},3e3))})</script><script async src="https://www.googletagmanager.com/gtag/js?id="></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","")</script><script src="/libs/others/clicklove.js"></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script type="text/javascript" src="/libs/others/snow.js"></script><script type="text/javascript" src="/js/click_show_text.js"></script><script type="text/javascript" color="220,220,220" opacity="0.7" zindex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script async src =“ https://cdn.jsdelivr.net/npm/perfops-rom”> </ script><script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script src="/live2d-widget/autoload.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"><style>[bg-lazy]{background-image:none!important;background-color:#eee!important}</style><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a=c[o],i=function(){c=c.filter(function(t){return a!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(a)};(t=a).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),i()):(e=new Image,n=t.getAttribute("data-original"),e.onload=function(){t.src=n,t.removeAttribute("data-original"),i()},t.src!==n&&(e.src=n))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this)</script></body></html>